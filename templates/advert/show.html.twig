{% extends 'base.html.twig' %}
{% block title %}{{ advert.title }}{% endblock %}

{% block body %}
    <div class="annonce-title" style="background-image: url({{ advert.coverImage }}) ">
        <div class="container">
            <h1 class="text-center">{{ advert.title }}</h1>
            <p>{{ advert.introduction }}</p>
            <p class="h2">
                <strong>{{ advert.rooms }} {% if advert.rooms > 1 %} chambres {% else %} chambre {% endif %} pour {{ advert.price }} € / nuit</strong>
            </p>
            <a href="#" class="btn btn-secondary mt-3 mb-3">Reserver</a>
        </div>
    </div>
    <div class="container text-center mt-5">
      <div class="row">
          <div class="col-md-8 mb-3">
              {{ advert.content | raw}}
              <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                  <ol class="carousel-indicators">
                      {% for image in advert.images %}
                      <li
                              data-target="#carouselExampleIndicators"
                              data-slide-to="{{ loop.index0 }}"
                              {% if loop.first %} class="active" {% endif %}>
                      </li>
                      {% endfor %}
                  </ol>
                  <div class="carousel-inner">
                      {% for image in advert.images %}
                      <div class="carousel-item {% if loop.first %} active {% endif %}">
                          <img class="d-block w-100" src="{{ image.url }}" alt="First slide">
                          <div class="carousel-caption d-none d-md-block">
                              <h5>{{ advert.title }}</h5>
                              <p>{{ image.caption }}</p>
                          </div>
                      </div>
                      {% endfor %}
                  </div>
                  <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                  </a>
                  <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                  </a>
              </div>
              <hr>
          </div>
          <div class="col">
              {% set advertAuthor = advert.author %}
              <div class="row mb-3 align-items-center">
                  <div class="col-4">
                      <a href="{{ path('user_show', {'id': advertAuthor.id, 'slug': advertAuthor.slug}) }}">
                          {% if advert.author.avatarUrl %}
                          <img src="{{ advert.author.avatarUrl }}" class="rounded-circle avatar-medium" title="Voir son profile" alt="Avatar de {{ advertAuthor.fullName }} ">
                          {% else %}
                              <img class="rounded-circle avatar-medium" src="{{ '/images/avatar_profile.png' }}" style="width: auto; height: auto" title="Voir son profile" alt="avatar de {{ app.user.fullName }}">
                          {% endif %}
                      </a>
                  </div>
                  <div class="col">
                      <a href="{{ path('user_show', {'id': advertAuthor.id, 'slug': advertAuthor.slug}) }}" title="Voir son profile">
                          <h3>{{ advertAuthor.fullName}} </h3>
                      </a>
                      <a href="{{ path('user_show', {'id': advertAuthor.id, 'slug': advertAuthor.slug}) }}" title="Voir les annonces">
                          <span class="badge badge-secondary py-3 px-4" style="font-size: 1.2em">
                          {{ advertAuthor.adverts | length }} {% if  advertAuthor.adverts | length > 1 %} annonces {% else %} annonce {% endif %}
                          </span>
                      </a>
                  </div>
                 <div>
                     {{ advertAuthor.introduction | raw }}
                 </div>
              </div>
          </div>
      </div>
      <div class="row">
         <div class="col">
            <a href="{{ path('advert_index') }}" class="btn btn-secondary mt-3 mb-3">Retour aux annonces</a>
         </div>
          {% if app.user and app.user == advert.author %}
             <div class="col">
                <a href="{{ path('advert_edit', {'slug': advert.slug, 'id': advert.id}) }}" class="btn btn-secondary mt-3 mb-3">
                    Modifier l'annonce »
                </a>
             </div>
             <div class="col mt-3">
                {{ include('advert/_delete_form.html.twig') }}
             </div>
          {% endif %}
      </div>
    </div>
{% endblock %}
